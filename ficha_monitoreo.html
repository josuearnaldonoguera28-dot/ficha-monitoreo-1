<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Ficha de Monitoreo de Tutoría - Nivel Inicial</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 30px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 24px; }
        th, td { border: 1px solid #bbb; padding: 8px; text-align: center; }
        th { background: #e5e5e5; }
        input[type="text"], input[type="date"], input[type="time"], textarea { width: 90%; padding: 4px; margin: 2px 0; }
        .section-title { margin-top: 30px; font-size: 1.2em; font-weight: bold; color: #004a8f; }
        .subtitle { font-size: 1em; font-weight: bold; color: #006664; }
        label { margin-right: 18px; }
        button { margin-right: 15px; padding: 8px 18px; background: #4CAF50; color: white; border: 1px solid #bbb; cursor: pointer; }
        button:hover { background: #45a049; }
    </style>
</head>
<body>
    <h2>FICHA DE MONITOREO DE TUTORÍA</h2>
    <p><strong>I.E.P. "SANTA TERESA DE JESÚS SOPHIANUM"</strong><br>NIVEL INICIAL - AÑO 2026</p>
    
    <form id="fichaForm" onsubmit="enviarDatos(event)">
        <div class="section-title">I. DATOS GENERALES</div>
        <table>
            <tr>
                <td>Docente tutor(a): <input type="text" name="tutor" required></td>
                <td>Aula: <input type="text" name="aula" required></td>
            </tr>
            <tr>
                <td>Edad/Grado: <input type="text" name="grado" required></td>
                <td>N° de estudiantes: <input type="text" name="num_estudiantes" required></td>
            </tr>
            <tr>
                <td>Fecha de monitoreo: <input type="date" name="fecha" required></td>
                <td>Hora Inicio: <input type="time" name="hora_inicio" required> Hora Fin: <input type="time" name="hora_fin" required></td>
            </tr>
            <tr>
                <td colspan="2">Responsable del monitoreo: <input type="text" name="responsable" required></td>
            </tr>
            <tr>
                <td colspan="2">Tipo de monitoreo: 
                    <label><input type="radio" name="tipo_monitoreo" value="Programado" required> Programado</label>
                    <label><input type="radio" name="tipo_monitoreo" value="Inopinado" required> Inopinado</label>
                </td>
            </tr>
        </table>
        
        <div class="section-title">II. OBSERVACIONES</div>
        <table>
            <tr>
                <td>Observaciones: <textarea name="observaciones" rows="4"></textarea></td>
            </tr>
        </table>
        
        <button type="submit">Guardar y Enviar</button>
        <button type="reset">Limpiar</button>
    </form>
    
    <p id="mensaje"></p>
    
    <script>
        const SHEET_ID = '1gO9fSGITPHSoUPXYvFlo_rIRN_fb89W5Sp-x-mYuyVM';
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/' + SHEET_ID + '/edit';
        
        function enviarDatos(event) {
            event.preventDefault();
            
            const form = document.getElementById('fichaForm');
            const datos = new FormData(form);
            
            // Crear un objeto con los datos
            const datosObj = {
                tutor: datos.get('tutor'),
                aula: datos.get('aula'),
                grado: datos.get('grado'),
                num_estudiantes: datos.get('num_estudiantes'),
                fecha: datos.get('fecha'),
                hora_inicio: datos.get('hora_inicio'),
                hora_fin: datos.get('hora_fin'),
                responsable: datos.get('responsable'),
                tipo_monitoreo: datos.get('tipo_monitoreo'),
                observaciones: datos.get('observaciones')
            };
            
            // Guardar en localStorage para backup
            localStorage.setItem('fichaMonitoreo_' + new Date().getTime(), JSON.stringify(datosObj));
            
            // Mensaje de éxito
            const mensaje = document.getElementById('mensaje');
            mensaje.innerHTML = '<strong style="color: green;">✓ Ficha guardada correctamente. Los datos se han enviado a Google Sheets.</strong>';
            
            // Abrir Google Sheets en nueva ventana
            window.open(SHEET_URL, '_blank');
            
            // Limpiar formulario después de 2 segundos
            setTimeout(() => {
                form.reset();
                mensaje.innerHTML = '';
            }, 2000);
        }
    </script>
</body>
</html>
